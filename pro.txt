import { Composer, Markup } from 'telegraf';
import type { CustomContext } from '../middlewares/userAuth';
import { escapeMarkdownV2 } from '../utils/escape';
import { prisma } from '../prisma';
import config from '../config/config.json';
import { changeCapital } from './economy';

const admins: number[] = config.manage.buildings.admins;
const building = new Composer<CustomContext>();

// Ù…Ù†ÙˆÛŒ Ø§ØµÙ„ÛŒ Ø³Ø§Ø®Øªâ€ŒÙˆØ³Ø§Ø²
building.action('building', async (ctx) => {
    const keyboard = Markup.inlineKeyboard([
        [Markup.button.callback('ğŸš— Ø®ÙˆØ¯Ø±ÙˆØ³Ø§Ø²ÛŒ', 'build_car')],
        [Markup.button.callback('ğŸ¬ ÙÛŒÙ„Ù…â€ŒØ³Ø§Ø²ÛŒ', 'build_film')],
        [Markup.button.callback('ğŸµ Ù…ÙˆØ²ÛŒÚ©â€ŒØ³Ø§Ø²ÛŒ', 'build_music')],
        [Markup.button.callback('ğŸ® Ø¨Ø§Ø²ÛŒâ€ŒØ³Ø§Ø²ÛŒ', 'build_game')],
        [Markup.button.callback('ğŸ”™ Ø¨Ø§Ø²Ú¯Ø´Øª', 'back_main'), Markup.button.callback('âŒ Ø¨Ø³ØªÙ†', 'delete')]
    ]);
    await ctx.reply('ğŸ— Ù†ÙˆØ¹ Ø³Ø§Ø®Øªâ€ŒÙˆØ³Ø§Ø² Ø±Ø§ Ø§Ù†ØªØ®Ø§Ø¨ Ú©Ù†:', keyboard);
    ctx.answerCbQuery();
});

// Ø´Ø±ÙˆØ¹ Ø³Ø§Ø®Øª Ù¾Ø±ÙˆÚ˜Ù‡
for (const type of ['car', 'film', 'music', 'game']) {
    building.action(`build_${type}`, async (ctx) => {
        ctx.session = {
            buildingType: type
        };

        if (type === 'car') {
            ctx.session.setupCost = 250_000_000;
            ctx.session.buildingStep = 'awaiting_name';
            await ctx.reply('ğŸ“Œ Ù†Ø§Ù… Ù¾Ø±ÙˆÚ˜Ù‡ Ø®ÙˆØ¯Ø±Ùˆ Ø±Ø§ ÙˆØ§Ø±Ø¯ Ú©Ù†:');
        } else {
            ctx.session.buildingStep = 'awaiting_setup_cost';
            await ctx.reply('ğŸ’° Ø³Ø±Ù…Ø§ÛŒÙ‡ Ø§ÙˆÙ„ÛŒÙ‡ Ù¾Ø±ÙˆÚ˜Ù‡ Ø±Ø§ ÙˆØ§Ø±Ø¯ Ú©Ù† (Ø¨ÛŒÙ† 55 ØªØ§ 750 Ù…ÛŒÙ„ÛŒÙˆÙ†):');
        }

        ctx.answerCbQuery();
    });
}

// Ø¯Ø±ÛŒØ§ÙØª Ù†Ø§Ù… Ù¾Ø±ÙˆÚ˜Ù‡
building.on('text', async (ctx, next) => {
    ctx.session ??= {};

    if (ctx.session.buildingStep === 'awaiting_setup_cost') {
        const raw = ctx.message.text?.trim();
        const cost = Number(raw.replace(/[^\d]/g, ''));
        if (isNaN(cost) || cost < 55_000_000 || cost > 750_000_000) {
            return ctx.reply('âŒ Ø¹Ø¯Ø¯ Ù…Ø¹ØªØ¨Ø± Ù†ÛŒØ³Øª. Ù„Ø·ÙØ§Ù‹ Ø¹Ø¯Ø¯ÛŒ Ø¨ÛŒÙ† 55 ØªØ§ 750 Ù…ÛŒÙ„ÛŒÙˆÙ† ÙˆØ§Ø±Ø¯ Ú©Ù†.');
        }

        const userId = BigInt(ctx.from.id);
        const user = await prisma.user.findUnique({ where: { userid: userId } });
        if (!user) return ctx.reply('âŒ Ú©Ø§Ø±Ø¨Ø± ÛŒØ§ÙØª Ù†Ø´Ø¯.');

        if (user.capital < BigInt(cost)) {
            return ctx.reply(
                `âŒ Ø¨ÙˆØ¯Ø¬Ù‡ Ú©Ø§ÙÛŒ Ù†Ø¯Ø§Ø±ÛŒØ¯!\n` +
                `ğŸ’° Ø³Ø±Ù…Ø§ÛŒÙ‡ Ù…ÙˆØ±Ø¯ Ù†ÛŒØ§Ø²: ${(cost / 1_000_000).toLocaleString()}M\n` +
                `ğŸ’³ Ø³Ø±Ù…Ø§ÛŒÙ‡ ÙØ¹Ù„ÛŒ Ø´Ù…Ø§: ${Number(user.capital / BigInt(1_000_000)).toLocaleString()}M`
            );
        }

        ctx.session.setupCost = cost;
        ctx.session.buildingStep = 'awaiting_name';
        await ctx.reply('ğŸ“Œ Ù†Ø§Ù… Ù¾Ø±ÙˆÚ˜Ù‡ Ø±Ø§ ÙˆØ§Ø±Ø¯ Ú©Ù†:');
        return;
    }

    if (ctx.session.buildingStep === 'awaiting_name') {
        const name = ctx.message.text?.trim();
        if (!name || name.length < 2) return ctx.reply('âŒ Ù†Ø§Ù… Ù…Ø­ØµÙˆÙ„ Ù…Ø¹ØªØ¨Ø± Ù†ÛŒØ³Øª.');

        ctx.session.buildingName = name;
        ctx.session.buildingStep = 'awaiting_image';
        await ctx.reply('ğŸ–¼ Ø­Ø§Ù„Ø§ ØªØµÙˆÛŒØ± Ù…Ø­ØµÙˆÙ„ Ø±Ø§ Ø§Ø±Ø³Ø§Ù„ Ú©Ù†:');
        return;
    }

    if (ctx.session.buildingStep === 'awaiting_build_description') {
        const description = ctx.message.text?.trim();
        if (!description || description.length < 5) return ctx.reply('âŒ ØªÙˆØ¶ÛŒØ­ Ø®ÛŒÙ„ÛŒ Ú©ÙˆØªØ§Ù‡Ù‡.');

        ctx.session.buildingDescription = description;
        ctx.session.buildingStep = 'awaiting_admin_review';

        const preview = escapeMarkdownV2(
            `ğŸ­ Ù¾ÛŒØ´â€ŒÙ†Ù…Ø§ÛŒØ´ Ø³Ø§Ø®Øª ${ctx.session.buildingType === 'car' ? 'Ø®ÙˆØ¯Ø±Ùˆ' : `Ù¾Ø±ÙˆÚ˜Ù‡ ${ctx.session.buildingType}`}\n\n` +
            `> Ú©Ø´ÙˆØ± Ø³Ø§Ø²Ù†Ø¯Ù‡: *${ctx.user?.countryName}*\n` +
            `> Ù…Ø­ØµÙˆÙ„: *${ctx.session.buildingName}*\n` +
            `> ØªÙˆØ¶ÛŒØ­: ${ctx.session.buildingDescription}\n\n` +
            `Ø¨ÙˆØ¯Ø¬Ù‡ Ø±Ø§Ù‡â€ŒØ§Ù†Ø¯Ø§Ø²ÛŒ: ${Math.floor(ctx.session.setupCost / 1_000_000)}M\n` +
            (ctx.session.buildingType === 'car' ? 'Ø¸Ø±ÙÛŒØª ØªÙˆÙ„ÛŒØ¯ Ø±ÙˆØ²Ø§Ù†Ù‡: 15 Ø®ÙˆØ¯Ø±Ùˆ\n\n' : '') +
            `âœ… Ø§Ú¯Ø± ØªØ£ÛŒÛŒØ¯ Ù…ÛŒâ€ŒÚ©Ù†ÛŒØŒ Ø¯Ú©Ù…Ù‡ Ø²ÛŒØ± Ø±Ø§ Ø¨Ø²Ù† ØªØ§ Ø¨Ø±Ø§ÛŒ Ø¨Ø±Ø±Ø³ÛŒ Ø§Ø¯Ù…ÛŒÙ† Ø§Ø±Ø³Ø§Ù„ Ø´ÙˆØ¯.`
        );

        const keyboard = Markup.inlineKeyboard([
            [Markup.button.callback('âœ… Ø§Ø±Ø³Ø§Ù„ Ø¨Ø±Ø§ÛŒ ØªØ£ÛŒÛŒØ¯ Ø§Ø¯Ù…ÛŒÙ†', 'submit_building')],
            [Markup.button.callback('ğŸ”™ Ø¨Ø§Ø²Ú¯Ø´Øª', 'building')]
        ]);

        await ctx.replyWithPhoto(ctx.session.buildingImageFileId, {
            caption: preview,
            parse_mode: 'MarkdownV2',
            reply_markup: keyboard.reply_markup
        });
        return;
    }

    return next();
});

// Ø¯Ø±ÛŒØ§ÙØª ØªØµÙˆÛŒØ±
building.on('photo', async (ctx, next) => {
    ctx.session ??= {};
    if (ctx.session.buildingStep !== 'awaiting_image') return next();

    const photo = ctx.message.photo?.at(-1);
    if (!photo) return ctx.reply('âŒ ØªØµÙˆÛŒØ± Ù…Ø¹ØªØ¨Ø± Ø§Ø±Ø³Ø§Ù„ Ù†Ø´Ø¯Ù‡.');

    const imageUrl = await ctx.telegram.getFileLink(photo.file_id);
    ctx.session.buildingImage = imageUrl.href;
    ctx.session.buildingImageFileId = photo.file_id;
    ctx.session.buildingStep = 'awaiting_build_description';

    await ctx.reply('ğŸ“ ØªÙˆØ¶ÛŒØ­ÛŒ Ø¯Ø±Ø¨Ø§Ø±Ù‡ Ù…Ø­ØµÙˆÙ„Øª Ø¨Ù†ÙˆÛŒØ³ (Ù…Ø«Ù„Ø§Ù‹ ÙˆÛŒÚ˜Ú¯ÛŒâ€ŒÙ‡Ø§ ÛŒØ§ Ù‡Ø¯Ù ØªÙˆÙ„ÛŒØ¯):');
});

// Ø§Ø±Ø³Ø§Ù„ Ø¯Ø±Ø®ÙˆØ§Ø³Øª Ø¨Ù‡ Ø§Ø¯Ù…ÛŒÙ†
building.action('submit_building', async (ctx) => {
    ctx.session ??= {};
    const { buildingType, buildingName, buildingImageFileId, buildingDescription, setupCost } = ctx.session;
    const userId = BigInt(ctx.from.id);
    const country = ctx.user?.countryName;

    if (!buildingType || !buildingName || !buildingImageFileId || !buildingDescription || !country) {
        return ctx.reply('âŒ Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ù†Ø§Ù‚Øµ Ø§Ø³Øª.');
    }

    const imageUrl = await ctx.telegram.getFileLink(buildingImageFileId).then(link => link.href);
    const result = await changeCapital(userId, 'subtract', setupCost);
    if (result !== 'ok') return ctx.reply('âŒ Ø®Ø·Ø§ Ø¯Ø± Ú©Ø³Ø± Ø³Ø±Ù…Ø§ÛŒÙ‡.');

    const profitPercent = buildingType === 'car' ? null : Math.floor(10 + Math.random() * 72);

    await prisma.pendingProductionLine.create({
        data: {
            ownerId: userId,
            name: buildingName,
            type: buildingType,
            imageUrl,
            imageFileId: buildingImageFileId,
            description: buildingDescription,
            dailyLimit: 15,
            setupCost: BigInt(setupCost),
            country,
            profitPercent
        }
    });

    const caption = escapeMarkdownV2(
        `ğŸ“¥ Ø¯Ø±Ø®ÙˆØ§Ø³Øª Ø³Ø§Ø®Øª ${buildingType === 'car' ? 'Ø®Ø· ØªÙˆÙ„ÛŒØ¯ Ø®ÙˆØ¯Ø±Ùˆ' : `Ù¾Ø±ÙˆÚ˜Ù‡ ${buildingType}`}\n\n` +
        `> Ú©Ø´ÙˆØ±: *${country}*\n` +
        `> Ù†Ø§Ù…: *${buildingName}*\n` +
        `> ØªÙˆØ¶ÛŒØ­: ${buildingDescription}\n` +
        `> Ø¨ÙˆØ¯Ø¬Ù‡: ${Math.floor(setupCost / 1_000_000)}M` +
        (profitPercent !== null ? `\n> Ø³ÙˆØ¯Ø¯Ù‡ÛŒ: ${profitPercent}%` : '') +
        (buildingType === 'car' ? `\nØ¸Ø±ÙÛŒØª ØªÙˆÙ„ÛŒØ¯ Ø±ÙˆØ²Ø§Ù†Ù‡: 15 Ø®ÙˆØ¯Ø±Ùˆ` : '')
    );

    const keyboard = Markup.inlineKeyboard([
        [Markup.button.callback('âœ… ØªØ£ÛŒÛŒØ¯ Ø³Ø§Ø®Øª', `admin_approve_building_${userId}`)],
        [Markup.button.callback('âŒ Ø±Ø¯ Ø¯Ø±Ø®ÙˆØ§Ø³Øª', `admin_reject_building_${userId}`)]
    ]);

    for (const admin of admins) {
        await ctx.telegram.sendPhoto(admin, buildingImageFileId, {
            caption,
            parse_mode: 'MarkdownV2',
            reply_markup: keyboard.reply_markup
        });
    }

    await ctx.reply('ğŸ“¤ Ø¯Ø±Ø®ÙˆØ§Ø³Øª Ø´Ù…Ø§ Ø¨Ø±Ø§ÛŒ Ø¨Ø±Ø±Ø³ÛŒ Ø§Ø¯Ù…ÛŒÙ† Ø§Ø±Ø³Ø§Ù„ Ø´Ø¯.');
    ctx.session.buildingStep = undefined;
});

// ØªØ£ÛŒÛŒØ¯ Ù†Ù‡Ø§ÛŒÛŒ ØªÙˆØ³Ø· Ø§Ø¯Ù…ÛŒÙ†
building.action(/admin_approve_building_(\d+)/, async (ctx) => {
    const userId = BigInt(ctx.match[1]);
    const user = await prisma.user.findUnique({ where: { userid: userId } });
    const pending = await prisma.pendingProductionLine.findFirst({ where: { ownerId: userId } });
    if (!user || !pending) return ctx.reply('âŒ Ø§Ø·Ù„Ø§Ø¹Ø§Øª ÛŒØ§ÙØª Ù†Ø´Ø¯.');

    // Ù…Ø­Ø§Ø³Ø¨Ù‡ Ø³ÙˆØ¯ Ø±ÙˆØ²Ø§Ù†Ù‡ Ø¨Ø±Ø§ÛŒ Ù¾Ø±ÙˆÚ˜Ù‡â€ŒÙ‡Ø§ÛŒ Ø¹Ù…Ø±Ø§Ù†ÛŒ
    let addedProfit = 0;
    if (pending.type !== 'car' && pending.profitPercent) {
        const base = Number(pending.setupCost);
        addedProfit = Math.floor(base * pending.profitPercent / 100);

        await prisma.user.update({
            where: { userid: userId },
            data: {
                dailyProfit: { increment: addedProfit }
            }
        });
    }

    await prisma.productionLine.create({
        data: {
            ownerId: userId,
            name: pending.name,
            type: pending.type,
            imageUrl: pending.imageUrl,
            imageFileId: pending.imageFileId,
            dailyLimit: pending.dailyLimit,
            setupCost: pending.setupCost,
            country: pending.country,
            profitPercent: pending.profitPercent
        }
    });

    await prisma.pendingProductionLine.delete({ where: { id: pending.id } });

    await ctx.telegram.sendPhoto(config.channels.updates, pending.imageFileId, {
        caption: escapeMarkdownV2(
            `ğŸ­ Ø®Ø· ØªÙˆÙ„ÛŒØ¯ Ø¬Ø¯ÛŒØ¯ Ø±Ø§Ù‡â€ŒØ§Ù†Ø¯Ø§Ø²ÛŒ Ø´Ø¯\n\n` +
            `> Ú©Ø´ÙˆØ± Ø³Ø§Ø²Ù†Ø¯Ù‡: *${user.countryName}*\n` +
            `> Ù…Ø­ØµÙˆÙ„: *${pending.name}*\n\n` +
            `Ø¨ÙˆØ¯Ø¬Ù‡ Ø±Ø§Ù‡â€ŒØ§Ù†Ø¯Ø§Ø²ÛŒ: ${pending.setupCost.toLocaleString()} Ø±ÛŒØ§Ù„\n` +
            `Ø¸Ø±ÙÛŒØª ØªÙˆÙ„ÛŒØ¯ Ø±ÙˆØ²Ø§Ù†Ù‡: ${pending.dailyLimit} ÙˆØ§Ø­Ø¯`
        ),
        parse_mode: 'MarkdownV2'
    });

    // Ù¾ÛŒØ§Ù… Ø¨Ù‡ Ú©Ø§Ø±Ø¨Ø± Ø¯Ø±Ø¨Ø§Ø±Ù‡ ØªØ£ÛŒÛŒØ¯ Ùˆ Ø³ÙˆØ¯Ø¯Ù‡ÛŒ
    try {
        let message =
            `âœ… Ù¾Ø±ÙˆÚ˜Ù‡ "${pending.name}" ØªØ£ÛŒÛŒØ¯ Ø´Ø¯ Ùˆ Ø®Ø· ØªÙˆÙ„ÛŒØ¯ ÙØ¹Ø§Ù„ Ø´Ø¯.\n` +
            `ğŸ— Ù†ÙˆØ¹ Ù¾Ø±ÙˆÚ˜Ù‡: ${pending.type}\n` +
            `ğŸ’° Ø¨ÙˆØ¯Ø¬Ù‡: ${Math.floor(Number(pending.setupCost) / 1_000_000)}M`;

        if (addedProfit > 0) {
            message += `\nâ• Ø³ÙˆØ¯ Ø±ÙˆØ²Ø§Ù†Ù‡: ${Math.floor(addedProfit / 1_000_000)}M Ø¨Ù‡ Ø­Ø³Ø§Ø¨ Ø³ÙˆØ¯ Ø´Ù…Ø§ Ø§Ø¶Ø§ÙÙ‡ Ø´Ø¯.`;
        }

        await ctx.telegram.sendMessage(Number(userId), message);
    } catch (err) {
        console.warn('âŒ Ø§Ø±Ø³Ø§Ù„ Ù¾ÛŒØ§Ù… Ø¨Ù‡ Ú©Ø§Ø±Ø¨Ø± Ù…Ù…Ú©Ù† Ù†Ø¨ÙˆØ¯:', err);
    }

    await ctx.reply('âœ… Ø®Ø· ØªÙˆÙ„ÛŒØ¯ Ø«Ø¨Øª Ø´Ø¯ Ùˆ Ø¨Ù‡ Ú©Ø§Ù†Ø§Ù„ Ø§Ø±Ø³Ø§Ù„ Ø´Ø¯.');
});


// Ø±Ø¯ Ø¯Ø±Ø®ÙˆØ§Ø³Øª ØªÙˆØ³Ø· Ø§Ø¯Ù…ÛŒÙ†
building.action(/admin_reject_building_(\d+)/, async (ctx) => {
    const userId = BigInt(ctx.match[1]);
    const adminId = ctx.from.id;

    if (!admins.includes(adminId)) {
        return ctx.answerCbQuery('â›” ÙÙ‚Ø· Ø§Ø¯Ù…ÛŒÙ† Ù…ÛŒâ€ŒØªÙˆÙ†Ù‡ Ø±Ø¯ Ú©Ù†Ù‡.');
    }

    const pending = await prisma.pendingProductionLine.findFirst({ where: { ownerId: userId } });

    if (!pending) {
        return ctx.answerCbQuery('âŒ Ø¯Ø±Ø®ÙˆØ§Ø³Øª ÛŒØ§ÙØª Ù†Ø´Ø¯.');
    }

    // Ø¨Ø±Ú¯Ø±Ø¯Ø§Ù†Ø¯Ù† Ù¾ÙˆÙ„
    const result = await changeCapital(userId, 'add', Number(pending.setupCost));
    if (result === 'not_found') {
        return ctx.answerCbQuery('âŒ Ú©Ø§Ø±Ø¨Ø± ÛŒØ§ÙØª Ù†Ø´Ø¯.');
    }
    if (result === 'invalid' || result === 'error') {
        return ctx.answerCbQuery('âŒ Ø®Ø·Ø§ Ø¯Ø± Ø¨Ø±Ú¯Ø±Ø¯Ø§Ù†Ø¯Ù† Ù¾ÙˆÙ„.');
    }

    // Ø­Ø°Ù Ø¯Ø±Ø®ÙˆØ§Ø³Øª
    await prisma.pendingProductionLine.deleteMany({ where: { ownerId: userId } });

    // Ø§Ø·Ù„Ø§Ø¹â€ŒØ±Ø³Ø§Ù†ÛŒ Ø¨Ù‡ Ú©Ø§Ø±Ø¨Ø±
    try {
        await ctx.telegram.sendMessage(Number(userId),
            `âŒ Ø¯Ø±Ø®ÙˆØ§Ø³Øª Ø³Ø§Ø®Øª Ø®Ø· ØªÙˆÙ„ÛŒØ¯ Ø´Ù…Ø§ Ø±Ø¯ Ø´Ø¯.\nğŸ’° Ù…Ø¨Ù„Øº ${Number(pending.setupCost / BigInt(1_000_000)).toLocaleString()}M Ø¨Ù‡ Ø­Ø³Ø§Ø¨ Ø´Ù…Ø§ Ø¨Ø±Ú¯Ø´Øª.`
        );
    } catch (err) {
        console.warn('Ø§Ø±Ø³Ø§Ù„ Ù¾ÛŒØ§Ù… Ø¨Ù‡ PV Ú©Ø§Ø±Ø¨Ø± Ù…Ù…Ú©Ù† Ù†Ø¨ÙˆØ¯:', err);
    }

    await ctx.answerCbQuery('âœ… Ø¯Ø±Ø®ÙˆØ§Ø³Øª Ø±Ø¯ Ø´Ø¯ Ùˆ Ù¾ÙˆÙ„ Ø¨Ø±Ú¯Ø´Øª.');
});

export default building;



buildings ro bbin
tafavotesh ba mine ine ke :
1. dar mine niyazi e taiin name , image , roll nadare
2. niyazi be taiid admin nadare


un ham schema hast :
// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
  output   = "../src/generated/client" // optional: client Ø±Ùˆ Ø¯Ø± src Ø¨Ø³Ø§Ø² Ø¨Ø±Ø§ÛŒ import Ø¢Ø³Ø§Ù†
}

datasource db {
  provider = "sqlite"
  url      = env("DATABASE_URL")
}

model User {
  userid       BigInt @id
  country      String
  countryName  String
  level        Int    @default(0)
  rank         Int    @default(0)
  government   String
  religion     String @default("islam")
  crowd        BigInt @default(15000000)
  capital      BigInt @default(150000000)
  dailyProfit  BigInt @default(100000000)
  satisfaction Int    @default(80)
  security     Int    @default(80)
  lottery      Int    @default(0)

  // Ù…Ù†Ø§Ø¨Ø¹
  oil         BigInt @default(0)
  iron        BigInt @default(0)
  gold        BigInt @default(0)
  uranium     BigInt @default(0)
  goldMine    BigInt @default(0)
  uraniumMine BigInt @default(0)
  ironMine    BigInt @default(0)
  refinery    BigInt @default(0)

  // Ø§Ø±ØªØ´ Ù¾Ø§ÛŒÙ‡
  soldier   BigInt @default(0)
  tank      BigInt @default(0)
  heavyTank BigInt @default(0)

  // Ø¬Ù†Ú¯Ù†Ø¯Ù‡â€ŒÙ‡Ø§
  su57 BigInt @default(0)
  f47  BigInt @default(0)
  f35  BigInt @default(0)
  j20  BigInt @default(0)
  f16  BigInt @default(0)
  f22  BigInt @default(0)
  am50 BigInt @default(0)
  b2   BigInt @default(0)
  tu16 BigInt @default(0)

  // Ù¾Ù‡Ù¾Ø§Ø¯Ù‡Ø§
  espionageDrone BigInt @default(0)
  suicideDrone   BigInt @default(0)
  crossDrone     BigInt @default(0)
  witnessDrone   BigInt @default(0)

  // Ù…ÙˆØ´Ú©â€ŒÙ‡Ø§
  simpleRocket      BigInt @default(0)
  crossRocket       BigInt @default(0)
  dotTargetRocket   BigInt @default(0)
  continentalRocket BigInt @default(0)
  ballisticRocket   BigInt @default(0)
  chemicalRocket    BigInt @default(0)
  hyperSonicRocket  BigInt @default(0)
  clusterRocket     BigInt @default(0)

  // Ú©Ø´ØªÛŒâ€ŒÙ‡Ø§ÛŒ Ø¯Ø±ÛŒØ§ÛŒÛŒ
  battleship       BigInt @default(0)
  marineShip       BigInt @default(0)
  breakerShip      BigInt @default(0)
  nuclearSubmarine BigInt @default(0)

  // Ø¯ÙØ§Ø¹
  antiRocket BigInt @default(0)
  ironDome   BigInt @default(0)
  s400       BigInt @default(0)
  taad       BigInt @default(0)
  hq9        BigInt @default(0)
  acash      BigInt @default(0)

  @@map("users")
}

model ProductionLine {
  id            Int      @id @default(autoincrement())
  ownerId       BigInt
  country       String
  name          String
  type          String // Ù…Ø«Ù„ 'car', 'game', 'movie'
  imageUrl      String
  imageFileId   String   @default("")
  dailyLimit    Int      @default(3)
  dailyOutput   Int      @default(15)
  setupCost     BigInt
  createdAt     DateTime @default(now())
  carName       String?
  unitPrice     Int? // ÙÙ‚Ø· Ø¨Ø±Ø§ÛŒ Ø®ÙˆØ¯Ø±Ùˆ
  profitPercent Int? // ÙÙ‚Ø· Ø¨Ø±Ø§ÛŒ Ù¾Ø±ÙˆÚ˜Ù‡â€ŒÙ‡Ø§ÛŒ Ø¹Ù…Ø±Ø§Ù†ÛŒ
}

model PendingProductionLine {
  id            Int      @id @default(autoincrement())
  ownerId       BigInt
  name          String
  type          String
  imageUrl      String
  imageFileId   String   @default("")
  description   String   @default("")
  dailyLimit    Int
  setupCost     BigInt
  country       String
  profitPercent Int?
  createdAt     DateTime @default(now()) // â† Ø§Ø¶Ø§ÙÙ‡ Ú©Ù†

  @@map("PendingProductionLine")
}

model Car {
  id        Int      @id @default(autoincrement())
  ownerId   BigInt
  name      String
  imageUrl  String
  price     Int
  createdAt DateTime @default(now())
}

model PendingBuilding {
  id        Int      @id @default(autoincrement())
  userId    BigInt
  carName   String
  imageUrl  String
  createdAt DateTime @default(now())
}
